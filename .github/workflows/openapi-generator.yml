# This workflow will regenerate the client library API bindings based on the
# public OpenAPI spec.

name: OpenAPI Generator

on:
  workflow_dispatch:
    inputs: null
  schedule:
    - cron: "0 0 * * *"

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Generate API Bindings
        uses: docker://openapitools/openapi-generator-cli:v4.3.1
        with:
          entrypoint: docker-entrypoint.sh
          args: |
            generate
              -i https://lilt.com/docs/public-http-api-swagger.yaml
              -g python
              -p packageName=lilt,projectName=lilt-python
              --git-user-id lilt
              --git-repo-id lilt-python
              -o .
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v3
        with:
          commit-message: Regenerates API Bindings
          title: "OpenAPI: Regenerates API Bindings"
          body: |
            Auto-generated by [create-pull-request][1]

            [1]: https://github.com/peter-evans/create-pull-request
          branch: openapi-bindings
